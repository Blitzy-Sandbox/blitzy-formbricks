---
title: "Spam Protection"
description: "Enable spam protection for your surveys using Cloudflare Turnstile or Google reCAPTCHA v3."
icon: "shield"
---

## Overview

Spam protection safeguards your Formbricks instance from spam and automated abuse by verifying that survey responses are submitted by real users. Formbricks supports two CAPTCHA providers:

- **Cloudflare Turnstile** — A privacy-focused CAPTCHA alternative that requires no user interaction and does not rely on tracking cookies.
- **Google reCAPTCHA v3** — An invisible, score-based CAPTCHA that assigns each request a risk score between 0.0 and 1.0.

The active provider is determined automatically based on which environment variables are configured. If both are configured, Turnstile takes precedence.

<Note>
  Spam protection is a paid feature. It is only available for users on paid plans or if you have [Enterprise
  Edition](/self-hosting/advanced/license).
</Note>

<Note>
  Spam protection does <strong>not</strong> work for surveys displayed with the Mobile SDKs (React Native, iOS,
  or Android SDKs). Enabling this setting in the Survey Editor will break the survey in those environments.
</Note>

## Provider Comparison

Use the table below to decide which CAPTCHA provider best fits your deployment:

| Feature | Cloudflare Turnstile | Google reCAPTCHA v3 |
|---------|---------------------|---------------------|
| User interaction | None | None (invisible) |
| Privacy | GDPR-friendly, no tracking cookies | Requires Google Terms of Service |
| Scoring model | Binary pass/fail | 0.0–1.0 risk score |
| Verification endpoint | `https://challenges.cloudflare.com/turnstile/v0/siteverify` | `https://www.google.com/recaptcha/api/siteverify` |
| Environment variables | `TURNSTILE_SITE_KEY`, `TURNSTILE_SECRET_KEY` | `RECAPTCHA_SITE_KEY`, `RECAPTCHA_SECRET_KEY` |

## Provider Setup

<Tabs>
  <Tab title="Cloudflare Turnstile">
    ### Key Generation

    1. Go to the [Cloudflare Turnstile dashboard](https://dash.cloudflare.com/?to=/:account/turnstile).
    2. Click **Add site** and configure your widget:
       - **Site name:** Any descriptive name (e.g., "Formbricks Self-Hosted").
       - **Domains:** Add your domain (e.g., `yourdomain.com`). For local development, add `localhost`.
       - **Widget mode:** Select **Managed** (recommended) or **Invisible**.
    3. Copy the generated **Site Key** and **Secret Key**.

    <Warning>
      Keep your Secret Key private. Never expose it in client-side code.
    </Warning>

    ### Configuration

    Add the following environment variables to your `.env` file or deployment environment:

    ```bash
    TURNSTILE_SITE_KEY=your_turnstile_site_key
    TURNSTILE_SECRET_KEY=your_turnstile_secret_key
    ```

    Restart your application after setting these variables. Formbricks detects the presence of both `TURNSTILE_SITE_KEY` and `TURNSTILE_SECRET_KEY` to enable Turnstile automatically.

    _Source: `apps/web/lib/constants.ts` — `TURNSTILE_SITE_KEY`, `TURNSTILE_SECRET_KEY`, `IS_TURNSTILE_CONFIGURED`_

    ### Firewall And Network Requirements

    If your self-hosted Formbricks instance is behind a firewall or proxy, ensure it can reach the Cloudflare Turnstile verification endpoint:

    - `https://challenges.cloudflare.com/turnstile/v0/siteverify`

    Allow outbound HTTPS (TCP port 443) traffic to `challenges.cloudflare.com`.
  </Tab>

  <Tab title="Google reCAPTCHA v3">
    ### Key Generation

    1. Go to the [Google reCAPTCHA admin console](https://www.google.com/recaptcha/admin/create).
    2. Register a new site:
       - **Label:** Any name (e.g., "Formbricks Self-Hosted").
       - **reCAPTCHA type:** Select **reCAPTCHA v3**.
       - **Domains:** Add your domain (e.g., `yourdomain.com`). For local development, add `localhost`.
       - Accept the terms and submit.
    3. Copy the generated **Site Key** and **Secret Key**.

    <Warning>
      Keep your Secret Key private. Never expose it in client-side code.
    </Warning>

    ### Configuration

    Add the following environment variables to your `.env` file or deployment environment:

    ```bash
    RECAPTCHA_SITE_KEY=your_recaptcha_site_key
    RECAPTCHA_SECRET_KEY=your_recaptcha_secret_key
    ```

    Restart your application after setting these variables. Formbricks detects the presence of both `RECAPTCHA_SITE_KEY` and `RECAPTCHA_SECRET_KEY` to enable reCAPTCHA automatically.

    _Source: `apps/web/lib/constants.ts` — `RECAPTCHA_SITE_KEY`, `RECAPTCHA_SECRET_KEY`, `IS_RECAPTCHA_CONFIGURED`_

    ### Firewall And Network Requirements

    If your self-hosted Formbricks instance is behind a firewall or proxy, ensure it can reach the Google reCAPTCHA verification endpoint:

    - `https://www.google.com/recaptcha/api/siteverify`

    Allow outbound HTTPS (TCP port 443) traffic to `www.google.com`.
  </Tab>
</Tabs>

## Steps To Enable Spam Protection

Once you have configured either Cloudflare Turnstile or Google reCAPTCHA v3 environment variables, you can enable spam protection per survey from the Survey Editor.

<Steps>
  <Step title="Open The Survey Editor">
    Navigate to the Survey Editor for the survey you want to protect.
  </Step>

  <Step title="Go To The Settings Tab">
    Click on the **Settings** tab next to the Questions & Styling tab.
  </Step>

  <Step title="Find Spam Protection Option">
    Scroll down to the **Response Options** section and find the **Spam Protection** toggle.
  </Step>

  <Step title="Enable Spam Protection">
    Toggle the **Spam Protection** option to activate CAPTCHA verification for this survey.
  </Step>

  <Step title="Configure The Threshold (reCAPTCHA Only)">
    If you are using Google reCAPTCHA v3, adjust the **response threshold**. This score determines how strictly responses are filtered:

    - A **lower** threshold (e.g., 0.1) is more lenient and allows most responses through.
    - A **higher** threshold (e.g., 0.9) is stricter and rejects more potentially automated responses.

    Cloudflare Turnstile uses a binary pass/fail check, so no threshold configuration is needed.

    ![Set reCAPTCHA Threshold](/images/xm-and-surveys/surveys/general-features/spam-protection/spam-protection.webp)
  </Step>

  <Step title="Save Your Changes">
    Click **Save** to apply spam protection settings to your survey.
  </Step>
</Steps>

Once enabled, all survey responses are verified through the configured CAPTCHA provider before being accepted.

For help, join the conversation on [GitHub Discussions](https://github.com/formbricks/formbricks/discussions).
