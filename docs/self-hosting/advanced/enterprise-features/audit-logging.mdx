---
title: Audit Logging
sidebarTitle: Audit Logging
description: Enable comprehensive audit logs for your Formbricks instance.
icon: file-shield
---

<Note>
  This feature requires an active Formbricks Enterprise License. [Learn more about licensing](/self-hosting/advanced/license).
</Note>

Audit logs record **who** did **what**, **when**, **from where**, and **with what outcome** across your Formbricks instance.


---

## Benefits of audit logging

- **Compliance readiness** — Many regulatory frameworks such as GDPR and SOC 2 require immutable records of user activity.
- **Security investigation support** — Audit logs provide clear visibility into user and system actions, helping teams respond quickly and confidently during security incidents.
- **Operational accountability** — Track changes across the system to answer common questions like "_who modified this?_" or "_when was this deleted?_".

---

## Enabling audit logging

1. Set the following environment variables in your deployment (Docker Compose, Kubernetes, etc.):

```bash title=".env"
# --- Audit logging ---
AUDIT_LOG_ENABLED=1
AUDIT_LOG_GET_USER_IP=1                        # set to 1 to include user IP address in audit logs, 0 to omit (default: 0)
```

2. Redeploy your containers.
3. Confirm you can see audit logs in the output of your containers.

Audit logs are printed to **stdout** as JSON Lines format, making them easily accessible through your container logs or log aggregation systems.

---

## Event Processing Architecture

Formbricks audit logging is designed for minimal performance overhead while ensuring reliable event capture.

### Async Queue Processing

Audit events are queued and processed asynchronously so that logging never blocks the main request flow. The `queueAuditEventBackground` function uses `setImmediate` to schedule audit event construction and dispatch outside the current request lifecycle, while `queueAuditEvent` provides a synchronous alternative for edge-runtime contexts such as API routes.

The `buildAndLogAuditEvent` function assembles the complete audit event object — including actor, action, target, status, timestamp, and optional change details — and passes it to the logging service.

> Source: `apps/web/modules/ee/audit-logs/lib/handler.ts`

### Zod-Validated Event Schemas

All audit events are validated against Zod schemas before storage and output, ensuring data integrity and a consistent event structure across the entire platform. The `ZAuditLogEventSchema` validates the following fields:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `actor` | Object (`id`, `type`) | Yes | The user, API key, or system entity that performed the action |
| `action` | Enum string | Yes | The action performed (see [Audit Action Types](#audit-action-types)) |
| `target` | Object (`id`, `type`) | Yes | The resource affected by the action |
| `status` | `success` or `failure` | Yes | Outcome of the operation |
| `timestamp` | ISO-8601 datetime | Yes | Time the action occurred |
| `organizationId` | String | Yes | Organization where the action occurred |
| `ipAddress` | String | No | Client IP address (present only when `AUDIT_LOG_GET_USER_IP=1`) |
| `changes` | Record | No | Changed fields (see below) |
| `eventId` | String | No | Correlation ID for error logs |
| `apiUrl` | URL | No | API endpoint URL if the event originated from an API call |

> Source: `apps/web/modules/ee/audit-logs/types/audit-log.ts` — `ZAuditLogEventSchema`

### Sensitive Data Redaction

Before an audit event is written, sensitive fields — including emails, access tokens, and passwords — are automatically redacted and replaced with `"********"`. The `redactPII()` function is applied to both old and new object snapshots, ensuring that personally identifiable information never reaches log storage.

> Source: `apps/web/modules/ee/audit-logs/lib/handler.ts` — `redactPII()`

### Change Tracking

When a resource is updated, Formbricks captures only the fields that actually changed by computing a diff between the old and new objects using `deepDiff()`. This minimizes log size and makes it straightforward to see exactly what was modified. If only a new object is available (e.g., on creation), the entire object is recorded after PII redaction.

> Source: `apps/web/modules/ee/audit-logs/lib/handler.ts` — `deepDiff(oldObject, newObject)`

---

## Audit Target Types

Every audit event references a **target** — the type of resource that was affected. The following 21 target types are supported:

| Target Type | Description |
|------------|-------------|
| `segment` | User segments for targeting |
| `survey` | Survey definitions |
| `webhook` | Webhook configurations |
| `user` | User accounts |
| `contactAttributeKey` | Contact attribute key definitions |
| `projectTeam` | Project-team assignments |
| `team` | Teams |
| `actionClass` | Action class definitions |
| `response` | Survey responses |
| `contact` | Contact records |
| `organization` | Organizations |
| `tag` | Response tags |
| `project` | Projects |
| `language` | Language configurations |
| `invite` | Membership invitations |
| `membership` | Organization memberships |
| `twoFactorAuth` | Two-factor authentication settings |
| `apiKey` | API keys |
| `integration` | Integration configurations |
| `file` | Uploaded files |
| `quota` | Quota settings |

> Source: `apps/web/modules/ee/audit-logs/types/audit-log.ts` — `ZAuditTarget`

---

## Audit Action Types

Every audit event records an **action** that describes what operation was performed. The following 25 action types are supported:

| Action Type | Description |
|------------|-------------|
| `created` | Resource created |
| `updated` | Resource updated |
| `deleted` | Resource deleted |
| `signedIn` | User signed in |
| `merged` | Resources merged (e.g., tags) |
| `verificationEmailSent` | Email verification sent |
| `createdFromCSV` | Resource created from CSV import |
| `copiedToOtherEnvironment` | Resource copied to another environment |
| `addedToResponse` | Item added to a response (e.g., tag) |
| `removedFromResponse` | Item removed from a response |
| `createdUpdated` | Resource created or updated (upsert) |
| `subscriptionAccessed` | Billing subscription accessed |
| `subscriptionUpdated` | Billing subscription updated |
| `twoFactorVerified` | Two-factor authentication verified |
| `emailVerified` | Email address verified |
| `jwtTokenCreated` | JWT token created |
| `authenticationAttempted` | Authentication attempted |
| `authenticationSucceeded` | Authentication succeeded |
| `passwordVerified` | Password verified |
| `twoFactorAttempted` | Two-factor authentication attempted |
| `twoFactorRequired` | Two-factor authentication required |
| `emailVerificationAttempted` | Email verification attempted |
| `userSignedOut` | User signed out |
| `passwordReset` | Password reset |
| `bulkCreated` | Resources bulk created |

> Source: `apps/web/modules/ee/audit-logs/types/audit-log.ts` — `ZAuditAction`

---

## Actor Types

Each audit event identifies the **actor** — the entity responsible for triggering the action. There are three actor types:

| Actor Type | Description |
|-----------|-------------|
| `user` | Action performed by a human user via the UI |
| `api` | Action performed via API key authentication |
| `system` | Action performed by the system automatically |

> Source: `apps/web/modules/ee/audit-logs/types/audit-log.ts` — `ZActor`

---

## Understanding the log format

Audit logs are **JSON Lines** (one JSON object per line). A typical entry looks like this:

```json
{"level":"audit","time":1749207302158,"pid":20023,"hostname":"Victors-MacBook-Pro.local","name":"formbricks","actor":{"id":"cm90t4t7l0000vrws5hpo5ta5","type":"api"},"action":"created","target":{"id":"cmbkov4dn0000vrg72i7oznqv","type":"webhook"},"timestamp":"2025-06-06T10:55:02.145Z","organizationId":"cm8zovtbm0001vr3efa4n03ms","status":"success","ipAddress":"unknown","apiUrl":"http://localhost:3000/api/v1/webhooks","changes":{"id":"cmbkov4dn0000vrg72i7oznqv","name":"********","createdAt":"2025-06-06T10:55:02.123Z","updatedAt":"2025-06-06T10:55:02.123Z","url":"https://eoy8o887lmsqmhz.m.pipedream.net","source":"user","environmentId":"cm8zowv0b0009vr3ec56w2qf3","triggers":["responseCreated","responseUpdated","responseFinished"],"surveyIds":[]}}
```

Key fields:

| Field | Description |
|-------|-------------|
| `level` | Log level, always `"audit"` for audit events |
| `time` | Unix timestamp in milliseconds |
| `pid` | Process ID of the logging instance |
| `hostname` | Hostname of the server generating the log |
| `name` | Application name, typically `"formbricks"` |
| `timestamp` | ISO‑8601 time of the action |
| `actor` | User or API key responsible (object with `id` and `type`) |
| `action` | Constant verb‑noun string (`survey.updated`, `login.failed`, …) |
| `target` | The resource affected (object with `id` and `type`) |
| `status` | `success` or `failure` |
| `organizationId` | Organization identifier where the action occurred |
| `ipAddress` | User IP address, present only if `AUDIT_LOG_GET_USER_IP=1`, otherwise `"unknown"` |
| `apiUrl` | (Optional) API endpoint URL if the logs was generated through an API call |
| `eventId` | (Optional) Available on error logs. You can use it to refer to the system log with this eventId for more details on the error |
| `changes` | (Optional) Only the fields that actually changed (sensitive values redacted) |

---

## Centralized logging and compliance

Formbricks audit logs are designed to work with modern centralized logging architectures:

- **Stdout delivery**: Logs are written to stdout for immediate collection by log forwarding agents
- **Centralized integrity**: Log integrity and immutability are handled by your centralized logging platform (ELK Stack, Splunk, CloudWatch, etc.)
- **Platform-level security**: Access controls and tamper detection are provided by your logging infrastructure
- **SOC2 compliance**: Most SOC2 auditors accept centralized logging without application-level integrity mechanisms

## Additional details

- **Redacted secrets:** Sensitive fields (e‑mails, access tokens, passwords…) are replaced with `"********"` before being written.
- **Failure events count:** Both successful *and* failed operations are logged.
- **Single source of truth:** The same logs power the `Formbricks` UI and API endpoints.
- **Scope limitation:** For now, **only events triggered inside the `Formbricks` application** are audited. This means:
  - **Embed and Link Surveys** are **not** included in the audit logs.
  - **Survey responses** created via the client API or client-side SDKs are **not** audited.

---
