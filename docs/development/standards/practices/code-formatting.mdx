---
title: "Code Formatting"
description: "Standards for consistent code formatting across the Formbricks project"
icon: code
---


## Core Configuration

### Prettier Config
Formbricks uses a standardized Prettier configuration defined in `@formbricks/config-prettier`:
```javascript
module.exports = {
  bracketSpacing: true,
  bracketSameLine: true,
  singleQuote: false,
  jsxSingleQuote: false,
  trailingComma: "es5",
  semi: true,
  printWidth: 110,
  arrowParens: "always",
  importOrder: [
    // Mocks must be at the top as they contain vi.mock calls
    "(.*)/__mocks__/(.*)",
    "server-only",
    "<THIRD_PARTY_MODULES>",
    "^@formbricks/(.*)$",
    "^~/(.*)$",
    "^@/(.*)$",
    "^[./]",
  ],
  importOrderSeparation: false,
  importOrderSortSpecifiers: true,
};
```

Key configurations:
- 110 characters line width
- Double quotes for strings
- ES5 trailing commas
- Always use parentheses for arrow functions
- Strict import ordering

`Source: packages/config-prettier/prettier-preset.js`

### Prettier Plugins

Formbricks uses Prettier v3.5.3 with three plugins to automate formatting tasks:

| Plugin | Version | Purpose |
|--------|---------|---------|
| `@trivago/prettier-plugin-sort-imports` | 5.2.2 | Automatic import sorting based on the `importOrder` configuration defined above |
| `prettier-plugin-tailwindcss` | 0.6.11 | Automatic Tailwind CSS class sorting in JSX `className` attributes |
| `prettier-plugin-sort-json` | 4.1.1 | Automatic JSON key sorting for consistent JSON file formatting |

These plugins are bundled in the `@formbricks/config-prettier` package and activated automatically when Prettier runs.

`Source: packages/config-prettier/package.json`

### Import Order
All imports follow a strict ordering enforced by the `@trivago/prettier-plugin-sort-imports` plugin:
1. Mocks (for testing) — `(.*)/__mocks__/(.*)`
2. Server-only imports — `server-only`
3. Third-party modules — `<THIRD_PARTY_MODULES>`
4. Internal `@formbricks/*` modules — `^@formbricks/(.*)$`
5. Local aliases `~/` — `^~/(.*)$`
6. Path aliases `@/` — `^@/(.*)$`
7. Relative imports — `^[./]`

### TypeScript Config
- Strict TypeScript checking enabled
- Consistent use of `tsconfig.json` extending from `@formbricks/config-typescript`
- Example configuration:

```json
{
  "compilerOptions": {
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "noEmit": true,
    "resolveJsonModule": true,
    "strict": true
  },
  "extends": "@formbricks/config-typescript/js-library.json",
  "include": ["src", "package.json"]
}
```

### JSDoc Comments
Required for public APIs and complex functions:

```typescript
/**
 * Creates a new user
 * @param {string} name - User's name
 * @returns {Promise<User>} The created user object
 */
function createUser(name: string): Promise<User> {
  // implementation
}
```

### Error Handling
Standardized error handling using the ErrorHandler class:

```typescript
export class ErrorHandler {
  private static instance: ErrorHandler | null;
  private handleError: (error: unknown) => void;
  public customized = false;
  public static initialized = false;

  private constructor(errorHandler?: (error: unknown) => void) {
    if (errorHandler) {
      this.handleError = errorHandler;
      this.customized = true;
    } else {
      this.handleError = (error) => {
        Logger.getInstance().error(JSON.stringify(error));
      };
    }
  }

  // ... additional methods
}
```

## Enforcement Tools

### Pre-Commit Hooks
Using Husky and lint-staged (v16.0.0) for automated formatting checks on staged files:

```json
{
  "lint-staged": {
    "(apps|packages)/**/*.{js,ts,jsx,tsx}": ["prettier --write"],
    "*.json": ["prettier --write"],
    "packages/database/schema.prisma": ["prisma format"]
  }
}
```

`Source: package.json (root)`

<Note>
  lint-staged runs **only Prettier formatting** on pre-commit — it does not run ESLint fixes. ESLint is run separately via `pnpm lint` as a workspace-level command through Turborepo. This separation ensures fast commits while keeping linting available as a dedicated check.
</Note>

### ESLint Configuration

Each package extends from `@formbricks/eslint-config` with specific presets tailored to its runtime environment. There are three primary presets built on the Vercel Engineering Style Guide and three legacy presets for older workspaces.

#### Primary Presets

| Preset | Target | Extends |
|--------|--------|---------|
| `library.js` | TypeScript packages | `@vercel/style-guide/eslint/node`, `@vercel/style-guide/eslint/typescript` |
| `next.js` | Next.js applications | node + TypeScript + browser + React + Next + Turbo configs |
| `react.js` | React library packages | browser + TypeScript + React configs |

- **`library.js`** — Configured for standalone TypeScript packages. Resolves `tsconfig.json` from the workspace root for type-aware linting. Includes the `@vitest` plugin for test conventions.
- **`next.js`** — Composes six Vercel style-guide presets for comprehensive Next.js coverage. Disables `import/no-default-export` to accommodate Next.js page and layout conventions. Includes the `@vitest` plugin.
- **`react.js`** — Applies browser, TypeScript, and React presets from the Vercel style guide. Disables `import/no-default-export` for component default exports. Includes an `overrides` section targeting `*.config.js` files to apply the Node environment.

#### Legacy Presets

| Preset | Target | Extends |
|--------|--------|---------|
| `legacy-library.js` | Older TypeScript packages | `turbo`, `prettier` |
| `legacy-next.js` | Older Next.js apps | `next`, `turbo`, `prettier` |
| `legacy-react.js` | Older React packages | `turbo`, `prettier`, `plugin:react-hooks/recommended` |

All six presets include the `@vitest` plugin and enforce the `@vitest/consistent-test-it` rule requiring the `test` keyword (not `it`) for all test declarations.

`Source: packages/config-eslint/`

### Workspace Commands

Run formatting and linting across the entire workspace using these root-level commands:

```bash
# Run Prettier formatting across all packages
pnpm format

# Run ESLint checks via Turborepo across all packages
pnpm lint
```

Both commands are defined in the root `package.json` and executed via Turborepo, ensuring consistent results across the entire monorepo.

### Continuous Integration
- Automated formatting checks in CI/CD pipeline
- SonarCloud integration for code quality analysis
- Coverage requirements for tests

## VS Code Integration

### Required Extensions
- `esbenp.prettier-vscode` - Prettier formatting
- `dbaeumer.vscode-eslint` - ESLint integration
- `bradlc.vscode-tailwindcss` - Tailwind CSS support

### Recommended Settings
```json
{
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": true
  },
  "typescript.tsdk": "node_modules/typescript/lib"
}
```

## Best Practices

1. **Consistent Formatting**
   - Always run `pnpm format` before committing
   - Use VS Code's format on save feature
   - Follow the established import order

2. **Type Safety**
   - Enable strict TypeScript checks
   - Use explicit type annotations when necessary
   - Avoid using `any` type

3. **Code Organization**
   - Keep files focused and modular
   - Group related functionality
   - Use clear, descriptive names

4. **Documentation**
   - Document complex logic
   - Use JSDoc for public APIs
   - Keep comments current with code changes

These standards ensure consistency across the Formbricks codebase while maintaining high code quality and developer productivity.
