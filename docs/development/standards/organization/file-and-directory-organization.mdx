---
title: File and Directory Org.
description: This document outlines the structure and organization of files and directories in the Formbricks codebase, providing guidelines for maintaining consistency and clarity across the project.
icon: folder-tree
---

## Project Structure Overview

The Formbricks codebase follows a monorepo structure using **pnpm workspaces** with **Turborepo** as the build orchestrator. The workspace is defined in `pnpm-workspace.yaml` with two top-level directory patterns:

- `apps/*` — Contains full applications
- `packages/*` — Contains shared libraries and utilities

Turborepo (`turbo.json`) manages parallel builds, caching, and task orchestration across the workspace. For the authoritative reference on project structure and conventions, see `AGENTS.md` at the repository root.

<Note>
  Source: `pnpm-workspace.yaml`, `turbo.json`, `AGENTS.md`
</Note>

## Apps Directory

The `apps/` directory contains two complete applications:

### apps/web/

- Main Formbricks production application (Next.js)
- Uses the App Router architecture
- Contains 16 feature modules under `modules/` (see [Module and Component Structure](/development/standards/organization/module-component-structure) for details)
- Houses environment-specific settings and configurations
- Playwright E2E tests reside in `apps/web/playwright/`

### apps/storybook/

- Storybook 10.1.11 for component documentation
- Visual documentation and testing of UI components
- Uses `@storybook/react-vite` for fast development builds
- Stories live in `stories.tsx` files alongside their components

## Packages Directory

The `packages/` directory contains 14 shared libraries and utilities consumed across the monorepo:

| Package | Description |
|---------|-------------|
| `packages/cache` | Redis caching abstraction (Valkey-compatible). Provides `cache.withCache()` and `createCacheKey.*` utilities for request-level and persistent caching. |
| `packages/config-eslint` | Shared ESLint configuration with presets: `library.js`, `next.js`, and `react.js`. |
| `packages/config-prettier` | Shared Prettier configuration (`prettier-preset.js`). Enforces 110-char width, semicolons, and double quotes. |
| `packages/config-typescript` | Shared TypeScript configuration files: `base.json`, `nextjs.json`, `react-library.json`, and more. |
| `packages/database` | Prisma 6.14.0 schema defining 32 models and 21 enums, plus 120+ migration files. |
| `packages/email` | Transactional email system built with React Email templates. Handles survey notifications, invitations, and follow-ups. |
| `packages/i18n-utils` | Internationalization utilities supporting 14 locales. |
| `packages/js-core` | Browser SDK core (7KB bundle). Powers in-product surveys via `formbricks.setup()` initialization. |
| `packages/logger` | Pino-based structured logging used across server-side modules. |
| `packages/storage` | S3-compatible storage abstraction supporting local filesystem, AWS S3, and MinIO backends. |
| `packages/survey-ui` | React UI toolkit containing 15 survey question elements (rating, NPS, matrix, etc.). |
| `packages/surveys` | Preact/React survey renderer. Pre-compiled via Vite to UMD + ESM bundles copied to `apps/web/public/js/`. |
| `packages/types` | Zod validation schemas and shared TypeScript type definitions used across the entire codebase. |
| `packages/vite-plugins` | Custom Vite build plugins for survey package compilation. |

<Note>
  Source: `packages/` filesystem, `AGENTS.md`
</Note>

## Web Application Modules

The main web application organizes its functionality into 16 feature modules under `apps/web/modules/`. Each module encapsulates a distinct domain of the platform:

| Module | Description |
|--------|-------------|
| `account` | User account management (profile, password, deletion) |
| `analysis` | Response analysis, insights, and summary dashboards |
| `api` | API v2 implementation (routes, middleware, OpenAPI generation) |
| `auth` | Authentication and authorization (login, signup, OAuth, CAPTCHA) |
| `core` | Core shared utilities, rate limiting, and middleware |
| `ee` | Enterprise features — contains 14 sub-modules (see below) |
| `email` | Email sending and template management |
| `environments` | Environment management (development, production) |
| `integrations` | Webhook management and native integrations dispatch |
| `organization` | Organization CRUD, API key management, member roles |
| `projects` | Project settings, configuration, and team assignment |
| `setup` | Fresh instance detection and onboarding wizard |
| `storage` | File storage management and upload handling |
| `survey` | Survey engine, editor, question types, templates, and responses |
| `ui` | Shared UI components used across feature modules |
| `utils` | Common utility functions and helpers |

The `ee/` module contains enterprise-only sub-modules that require a valid enterprise license:

| Sub-Module | Description |
|------------|-------------|
| `audit-logs` | Async audit event logging with Zod-validated entries |
| `auth` | Enterprise authentication extensions |
| `billing` | Stripe-based subscription management and plan tiers |
| `contacts` | Contact management and segment-based targeting |
| `languages` | Language configuration for multi-language surveys |
| `license-check` | Remote license validation with caching and grace period |
| `mailing` | Enterprise mailing extensions |
| `multi-language-surveys` | Multi-language survey rendering (14 locales) |
| `quotas` | Usage quotas and plan-based response limits |
| `role-management` | Fine-grained role-based access control |
| `sso` | SAML and OIDC single sign-on |
| `teams` | Team-based access control (admin, contributor roles) |
| `two-factor-auth` | TOTP two-factor authentication with backup codes |
| `whitelabel` | White-label branding and "Powered by" removal |

For detailed module organization guidelines, see [Module and Component Structure](/development/standards/organization/module-component-structure).

## Module Organization

### Core Module Structure

Each feature module follows a consistent internal structure. Modules should be self-contained with clear boundaries:

```text
modules/
└── your-feature/
    ├── actions/       # Server actions (or actions.ts for simpler modules)
    ├── components/    # React components
    ├── hooks/         # Custom React hooks
    ├── lib/           # Business logic and service functions
    ├── types/         # TypeScript type definitions
    └── route.ts       # API routes (if needed)
```

Server actions wrap service calls and return `{ data }` or `{ error }` consistently. For a full reference on module conventions, see [Module and Component Structure](/development/standards/organization/module-component-structure).

## Adding New Code

### New Features

When adding new features, follow these guidelines:

1. **Determine Scope**:

   - Complete application → `apps/`
   - Shared library → `packages/`
   - Feature for existing app → appropriate module in `apps/web/modules/`

2. **Module Creation**:
   Create a new module with the standard structure:

   ```text
   modules/
   └── your-feature/
       ├── actions/       # Server actions (or actions.ts)
       ├── components/    # React components
       ├── hooks/         # Custom React hooks
       ├── lib/           # Business logic
       ├── types/         # TypeScript types
       └── route.ts       # API routes (if needed)
   ```

3. **Component Organization**:

   - Base UI components → `modules/ui/components/`
   - Feature-specific components → `modules/[feature]/components/`

4. **Naming Conventions**:

   - Follow the patterns defined in [Naming Conventions](/development/standards/organization/naming-conventions)
   - Use kebab-case for files and directories
   - Use PascalCase for React components and module folders

## Workspace Configuration

The monorepo workspace is configured via `pnpm-workspace.yaml` at the repository root:

```yaml
packages:
  - "apps/*"
  - "packages/*"

# Allow lifecycle scripts for packages that need to build native binaries
# Required for pnpm v10+ which blocks scripts by default
onlyBuiltDependencies:
  - sharp
  - esbuild
  - prisma
  - "@prisma/client"
  - "@prisma/engines"
```

The `onlyBuiltDependencies` list is required because pnpm v10+ blocks lifecycle scripts by default for security. Only the listed packages are permitted to run postinstall scripts for native binary compilation.

<Note>
  Source: `pnpm-workspace.yaml`
</Note>

## Testing Organization

### Test File Placement

Test files follow specific conventions depending on the type of test:

- **Unit tests** sit next to their source files as `*.test.ts` or inside `__tests__/` directories
- **E2E tests** belong in `apps/web/playwright/` using descriptive filenames (e.g., `billing.spec.ts`)
- **Mock files** go inside `__mocks__/` directories to keep import ordering stable

### Test File Suffixes

| Suffix | Type | Runner |
|--------|------|--------|
| `.test.ts` | Unit test | Vitest with Testing Library |
| `.spec.ts` | E2E test | Playwright |

### Testing Rules

- Use **Vitest** with Testing Library for logic in `.ts` files
- Do **NOT** write tests for `.tsx` files — React components are covered by Playwright E2E tests instead
- Run `pnpm test` before opening a PR and `pnpm test:coverage` when touching critical flows
- Keep coverage from regressing

<Warning>
  Do not write unit tests for `.tsx` files. React component testing is handled exclusively through Playwright E2E tests in `apps/web/playwright/`.
</Warning>

### Test Directory Example

```text
feature/
├── __tests__/             # Grouped unit tests (alternative to colocated .test.ts)
│   └── user-service.test.ts
├── __mocks__/             # Mock files for dependencies
├── components/            # Feature components (tested via Playwright)
└── lib/
    ├── user-service.ts
    └── user-service.test.ts  # Colocated unit test
```

<Note>
  Source: `AGENTS.md` Testing Guidelines section
</Note>

## Configuration Files

### Root Level Configuration

The repository root contains essential configuration files:

| File | Purpose |
|------|---------|
| `package.json` | Root package metadata, workspace scripts, and dependency management |
| `pnpm-workspace.yaml` | Workspace configuration defining `apps/*` and `packages/*` patterns |
| `turbo.json` | Turborepo pipeline configuration for builds, tests, and task orchestration |
| `tsconfig.json` | Root TypeScript configuration |
| `.env` / `.env.example` | Environment variables (75+ variables for production configuration) |
| `.eslintrc.js` | Root ESLint configuration (extends shared config from `packages/config-eslint`) |
| `.prettierrc.js` | Root Prettier configuration (extends shared config from `packages/config-prettier`) |

### Package Level Configuration

Each package and app maintains its own configuration files:

- `package.json` — Package-specific dependencies and scripts
- `tsconfig.json` — Package-specific TypeScript settings (extends from `packages/config-typescript`)
- `.eslintrc.js` — Package-specific linting rules (extends from `packages/config-eslint`)

## Deployment Collateral

Deployment-related files and directories are organized outside the application code:

| Directory | Description |
|-----------|-------------|
| `docs/` | Mintlify documentation workspace (MDX content, images, `docs.json` navigation) |
| `docker/` | Docker deployment files: `docker-compose.yml`, `formbricks.sh` one-click installer, migration scripts |
| `charts/` | Kubernetes Helm chart for cluster deployments |

<Note>
  Source: `AGENTS.md`
</Note>

## Best Practices

### Code Organization

- Keep modules focused and single-purpose
- Maintain clear separation between UI and business logic
- Use proper TypeScript interfaces and types

### File Structure

- Group related files in descriptive directories
- Use consistent [Naming Conventions](/development/standards/organization/naming-conventions) across the codebase
- Keep files focused and modular

### Module Independence

- Minimize dependencies between modules
- Share common utilities through appropriate packages
- Maintain clear module boundaries

### Documentation

- Document complex logic and APIs as laid out in the [Documentation](/development/standards/practices/documentation) section
- Keep documentation current with code changes
- Add frontmatter with `title`, `description`, and `icon` to all MDX files

## Version Control

### Git Organization

- `.gitignore` — Specifies ignored files and directories
- `.github/` — GitHub-specific configurations, CI/CD workflows (19 workflow files), and composite actions
- `LICENSE` — AGPLv3 license with EE dual-licensing model
- `CONTRIBUTING.md` — Community contribution guidelines
- `SECURITY.md` — Security vulnerability reporting policy

## Related Resources

For more details on specific organization topics, see the following pages:

- [Module and Component Structure](/development/standards/organization/module-component-structure) — Detailed module conventions and patterns
- [Naming Conventions](/development/standards/organization/naming-conventions) — File, directory, and code symbol naming rules
- [Documentation Standards](/development/standards/practices/documentation) — Guidelines for writing internal documentation
