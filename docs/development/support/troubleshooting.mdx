---
title: "Troubleshooting"
description: "Here, you'll find help with common issues."
icon: "wrench"
---

## The App Doesn't Work After Prisma Migration

If the app doesn't work after a Prisma migration, clear your browser's storage and reload the page. This will force the app to fetch data from the server again. ![prisma](https://res.cloudinary.com/dwdb9tvii/image/upload/v1738108186/image_dwm9hp.jpg)

<Note>
  After running a Prisma migration, make sure to apply it with `pnpm db:migrate:dev` and then restart the dev server with `pnpm dev`.
</Note>

## I Ran 'pnpm i' But There Seems To Be An Error With The Packages

If you run `pnpm i` and get an error with the packages, try running `pnpm clean` followed by `pnpm i` again. This often solves the problem.

The `pnpm clean` command removes `node_modules`, `.turbo` cache, `coverage`, and `out` directories. If that doesn't resolve the issue, try a full clean which also removes `pnpm-lock.yaml`:

```bash
pnpm clean:all
pnpm install
```

## I Get A Full-Screen Error With Cryptic Strings

This usually happens when the Formbricks survey bundle isn't correctly or completely built. The `@formbricks/surveys` package is pre-compiled (Vite → UMD + ESM) and must be rebuilt after changes.

```bash
rm -rf packages/surveys/dist apps/web/public/js/surveys.* node_modules/.cache/turbo
pnpm build --filter=@formbricks/surveys... --force

# Run the app again
pnpm dev
```

Source: `AGENTS.md` (Survey Packages Build & Cache section)

## My Machine Struggles With The Repository

Since we're working with a monorepo structure, the repository can get quite big. If you're having trouble working with the repository, try the following:

```bash
pnpm dev --filter=@formbricks/web...
```

It's better to use a single terminal with `pnpm dev` rather than having multiple open (one with the Formbricks app and one with the demo).

## Uncaught SyntaxError: Unexpected Token DOCTYPE

If you see this error, it happens when the person connected to the widget is deleted. To fix it, log out of the test person and reload the page.

![Syntax Error](https://res.cloudinary.com/dwdb9tvii/image/upload/v1738109837/image_wbxv8k.jpg)

![Reset person](https://res.cloudinary.com/dwdb9tvii/image/upload/v1738110212/image_nvkpku.jpg)

## Node.js Version Mismatch Errors

Formbricks requires **Node.js ≥20.0.0** as specified in the `package.json` engines field. The project also uses **pnpm 10.28.2** as the package manager (specified in `package.json` `packageManager` field), which requires Node.js ≥20.

**Symptoms:** Build failures, unexpected syntax errors, or "unsupported engine" warnings during `pnpm install`.

**Solution:** Check your current version and switch to Node.js 20 LTS or later using `nvm` or `fnm`:

```bash
# Check current Node.js version
node -v

# Switch to Node.js 20 LTS using nvm
nvm install 20
nvm use 20

# Verify version
node -v  # Should output v20.x.x or higher
```

<Note>
  If you see "unsupported engine" warnings, verify both your Node.js version (`node -v`) and pnpm version (`pnpm -v`). The project requires Node.js ≥20.0.0 and pnpm 10.28.2.
</Note>

Source: `package.json` (`engines.node >= 20.0.0`, `packageManager: pnpm@10.28.2`)

## pnpm Workspace Dependency Resolution Issues

Formbricks uses pnpm workspaces with `apps/*` and `packages/*` directories defined in `pnpm-workspace.yaml`. Dependency resolution must happen from the repository root.

**Symptoms:** "Cannot find module" errors, unresolved workspace dependencies, or phantom dependency issues.

**Solutions:**

1. Run `pnpm install` from the repository root (not from within a workspace package).
2. If dependencies are stale, delete `node_modules` and reinstall:

```bash
pnpm clean
pnpm install
```

3. If the problem persists, try a full clean that also removes `pnpm-lock.yaml` and `.turbo`:

```bash
pnpm clean:all
pnpm install
```

4. Verify you're using the correct pnpm version by running `pnpm -v` (should output `10.28.2`).

<Note>
  Always run `pnpm install` from the repository root. Running it from a nested workspace directory can lead to incomplete dependency resolution.
</Note>

Source: `package.json` (`packageManager: pnpm@10.28.2`), `pnpm-workspace.yaml`

## Turborepo Cache Invalidation

Formbricks uses **Turborepo 2.5.3** which caches build outputs aggressively for performance. This can occasionally cause stale artifacts.

**Symptoms:** Changes not reflected after rebuilding, stale build artifacts, unexpected behavior after switching branches.

**Solutions:**

1. Force bypass the cache for a specific build:

```bash
pnpm build --force
```

2. Delete the Turborepo cache directory:

```bash
rm -rf .turbo
```

3. For a complete cache reset including the `node_modules` Turborepo cache:

```bash
rm -rf .turbo node_modules/.cache/turbo
pnpm build
```

<Note>
  After switching Git branches, it's recommended to run `rm -rf .turbo` to avoid stale cache artifacts from the previous branch.
</Note>

Source: `AGENTS.md` (Survey Packages Build & Cache section), `turbo.json`

## Docker Dev Services Connection Issues

Local development relies on Docker services defined in `docker-compose.dev.yml`. These services are started and stopped via `pnpm db:up` and `pnpm db:down`.

**Symptoms:** "Connection refused" errors, database connection failures, email not working in development.

The following services must be running for local development:

| Service | Image | Ports | Purpose |
|---------|-------|-------|---------|
| postgres | pgvector/pgvector:pg17 | 5432 | PostgreSQL database with vector extensions |
| mailhog | arjenz/mailhog | 8025, 1025 | Email testing (web UI + SMTP) |
| valkey | valkey/valkey | 6379 | Redis-compatible cache |
| minio | minio/minio | 9000, 9001 | S3-compatible file storage |

**Solutions:**

1. Start Docker services:

```bash
pnpm db:up
```

2. Verify services are running:

```bash
docker compose -f docker-compose.dev.yml ps
```

3. Check that no other services are using ports 5432, 6379, 8025, 1025, 9000, or 9001.

4. If PostgreSQL won't start, reset the volume:

```bash
docker compose -f docker-compose.dev.yml down -v
pnpm db:up
```

<Warning>
  Running `docker compose down -v` will delete all data in your local PostgreSQL database. You will need to re-run migrations with `pnpm db:migrate:dev`.
</Warning>

MinIO local development credentials: user `devminio`, password `devminio123`. The MinIO web console is available at `http://localhost:9001`.

Source: `docker-compose.dev.yml`

## Prisma Migration Conflicts And Database Reset

Prisma migrations are managed in `packages/database/` with 120+ migration files. Conflicts can occur when rebasing or pulling upstream changes.

**Symptoms:** "Migration failed" errors, schema drift warnings, Prisma errors `P3006` or `P3009`.

**Solutions:**

1. Apply pending migrations:

```bash
pnpm db:migrate:dev
```

2. If migrations are conflicting (e.g., after rebasing or pulling upstream changes):

```bash
# Reset the database (WARNING: deletes all data)
npx prisma migrate reset --schema packages/database/schema.prisma

# Re-apply all migrations
pnpm db:migrate:dev
```

3. For persistent schema drift issues:

```bash
# Generate a fresh migration from current schema state
npx prisma migrate dev --schema packages/database/schema.prisma --name fix_drift
```

4. After any database reset, you may need to seed data:

```bash
pnpm db:seed
```

<Warning>
  The `prisma migrate reset` command drops the entire database and recreates it. Only use this in your local development environment — never in production.
</Warning>

Source: `packages/database/` (Prisma schema and migrations), `AGENTS.md` (`pnpm db:migrate:dev`)

## Survey Package Build Cache Issues

The `@formbricks/surveys` package is pre-compiled (Vite → UMD + ESM) and the built bundle is copied to `apps/web/public/js/`. The Next.js app imports from `dist/`, **not** the source files. This is one of the most common development issues — the survey bundle must be rebuilt manually after any source change.

**Symptoms:** Survey changes not appearing in the browser, stale survey UI, "module not found" errors for survey components.

**Solutions:**

1. After **any** change to `packages/surveys` or its dependencies (`packages/survey-ui`, `packages/types`, etc.), you must rebuild:

```bash
rm -rf packages/surveys/dist apps/web/public/js/surveys.* node_modules/.cache/turbo
pnpm build --filter=@formbricks/surveys... --force
```

2. After rebuilding, do a hard refresh in the browser (Cmd+Shift+R on macOS / Ctrl+Shift+R on Windows/Linux) or disable the browser cache via DevTools.

3. If changes still don't appear, restart the Next.js dev server:

```bash
pnpm dev
```

<Note>
  Turborepo caches build outputs aggressively. Always use `--force` to bypass the cache when iterating on survey packages.
</Note>

Source: `AGENTS.md` (Survey Packages Build & Cache section, lines 18-29)

## Browser Cache Stale Bundle Issues

The browser caches the UMD bundle (`surveys.umd.cjs`) served from `public/js/`. Even after rebuilding the survey packages on disk, the browser may continue serving the previously cached version.

**Symptoms:** After rebuilding survey packages, changes still don't appear in the browser; old survey UI is displayed despite successful rebuild.

**Solutions:**

1. Do a hard refresh: **Cmd+Shift+R** (macOS) or **Ctrl+Shift+R** (Windows/Linux).
2. Open DevTools → Network tab → check the **Disable cache** checkbox, then reload the page.
3. Clear browser application cache: DevTools → Application → Storage → **Clear site data**.
4. In some cases, close and reopen the browser tab entirely.

<Note>
  If you've rebuilt the survey packages and still see old UI, always try a hard refresh first. The browser's disk cache can persist stale bundles even after the files on disk have been updated.
</Note>

Source: `AGENTS.md` (lines 28-29)
